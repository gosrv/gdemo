# 推荐集群结构
没有对集群拓扑结构进行限制，可自行组织，下面的结构可以试用大多数情况，如无特殊需求可以试用下面的结构，无论是世界服还是单服
```

+------------+  +----------+   +----------+  +-----------+
|  guide     |  |  guide   |   |   match  |  |   team    |
|            |  |          |   |          |  |           |
+-----^------+  +----^-----+   +-----^----+  +-----^-----+
      |              |               |             |
      |              |               |             |
+-----+--------------v---------------+-------------+-----------+
|                                                              |
|                      message queue                           |
|                                                              |
|                                                              |
+------^----------------------^-----------------------^--------+
       |                      |                       |
       |                      |                       |
+------v-------+      +-------v-------+     +---------v--------+
|              |      |               |     |                  |
|   baseapp    |      |    baseapp    |     |      battleapp   |
|              |      |               |     |                  |
+------^-------+      +-------^-------+     +---------^--------+
       |                      |                       |
       |                      |                       |
+------v----------------------v-----------------------v--------+
|                                                              |
|                  gateway (nginx)                             |
|                                                              |
|                                                              |
+--------------------------------------------------------------+

```
特点：所有服务器可以水平扩展，通过消息队列解耦所有服务器，后端服务器可以进行动态负载均衡，通过滚服实现逻辑热更
前端使用nginx作为网关（如果有必要的话，比如需要https或者wss代理），如果不需要可以直接对外开放
baseapp用来处理玩家数据，比如基本数据、背包、宠物、装备等，可以水平扩展
battleapp用来处理战斗逻辑，可以水平扩展
guide工会服,team服（可以放到一起），可以水平扩展，可以动态负载均衡（还未实现）
每玩家在redis中有一个消息队列，用来传送玩家之间的数据交互
服务节点之间试用nodemq进行通信，目前有两种nodemq，一个使用过tcp连接建立的网络mq，一种是使用redis的list实现的mq